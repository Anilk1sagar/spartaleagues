{"version":3,"sources":["../../src/middleware/errorHandler.js"],"names":["errorHandler","err","req","res","next","logger","info","console","log","sendStatus","error","message","Config","isProduction","stack","errors","type","debug","status","code","json"],"mappings":";;;;;kBAIwBA,Y;;AAJxB;;;;AACA;;;;;;AAGe,SAASA,YAAT,CAAsBC,GAAtB,EAA2BC,GAA3B,EAAgCC,GAAhC,EAAqCC,IAArC,EAA2C;;AAEtDC,qBAAOC,IAAP,CAAY,qEAAZ;;AAEAC,YAAQC,GAAR,CAAY,eAAZ;AACA,QAAI,CAACP,GAAL,EAAU;AACN,eAAOE,IAAIM,UAAJ,CAAe,GAAf,CAAP;AACH;;AAGD,UAAMC,QAAQ;AACVC,iBAASV,IAAIU,OAAJ,IAAe;AADd,KAAd;;AAIA,QAAIC,iBAAOC,YAAP,EAAJ,EAA2B;AACvBH,cAAMI,KAAN,GAAc,EAAd;AACH,KAFD,MAEO;AACHJ,cAAMI,KAAN,GAAcb,IAAIa,KAAlB;AACH;;AAED;AACA;AACA;;AAEA,QAAIb,IAAIc,MAAR,EAAgB;;AAEZL,cAAMK,MAAN,GAAe,EAAf;;AAEA,cAAM,EAAEA,MAAF,KAAad,GAAnB;;AAEA,aAAK,MAAMe,IAAX,IAAmBD,MAAnB,EAA2B;AACvB,gBAAIC,QAAQD,MAAZ,EAAoB;AACpBL,sBAAMK,MAAN,CAAaC,IAAb,IAAqBD,OAAOC,IAAP,EAAaL,OAAlC;AACC;AACJ;AACJ;;AAEDJ,YAAQC,GAAR,CAAYP,GAAZ;AACA;AACA;AACAI,qBAAOY,KAAP,CAAa,sBAAb,EAAqChB,GAArC;AACAE,QAAIe,MAAJ,CAAWjB,IAAIkB,IAAJ,IAAY,GAAvB,EAA4BC,IAA5B,CAAiCV,KAAjC;AAEH","file":"errorHandler.js","sourcesContent":["import Config from './../config'\r\nimport logger from './../utils/logger';\r\n\r\n\r\nexport default function errorHandler(err, req, res, next) {\r\n\r\n    logger.info(\"*********************** errorHandler started **********************\");\r\n\r\n    console.log(\"working error\");\r\n    if (!err) {\r\n        return res.sendStatus(500);\r\n    }\r\n\r\n\r\n    const error = {\r\n        message: err.message || 'Internal Server Error.',\r\n    };\r\n\r\n    if (Config.isProduction()) {\r\n        error.stack = {};\r\n    } else {\r\n        error.stack = err.stack;\r\n    }\r\n\r\n    // if (process.env.RUN_MODE==='dev') {\r\n    //   error.stack = err.stack;\r\n    // }\r\n\r\n    if (err.errors) {\r\n\r\n        error.errors = {};\r\n\r\n        const { errors } = err;\r\n\r\n        for (const type in errors) {\r\n            if (type in errors) {\r\n            error.errors[type] = errors[type].message;\r\n            }\r\n        }\r\n    }\r\n\r\n    console.log(err);\r\n    //log.info(\"dede\");\r\n    //res.status(err.status || 500).json(error);\r\n    logger.debug(\" error middleware {}\", err);\r\n    res.status(err.code || 500).json(error);\r\n\r\n}"]}